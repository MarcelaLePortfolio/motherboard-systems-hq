services:
  workerA:
    networks:
      - mbhq_default
    image: mbhq-worker:phase32
    volumes:
      - ./server/worker:/app/server/worker:ro
    command: ["node","server/worker/phase26_task_worker.mjs"]
    environment:
      POSTGRES_URL: postgres://postgres:postgres@host.docker.internal:5432/postgres
      PHASE26_TICK_MS: "250"
      WORKER_OWNER: docker-wA
      PHASE32_CLAIM_ONE_SQL: sql/phase40_claim_one_tierA.sql
      PHASE32_MARK_SUCCESS_SQL: server/worker/phase32_mark_success.sql
      PHASE32_MARK_FAILURE_SQL: server/worker/phase32_mark_failure.sql
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

  workerB:
    networks:
      - mbhq_default
    image: mbhq-worker:phase32
    volumes:
      - ./server/worker:/app/server/worker:ro
    command: ["node","server/worker/phase26_task_worker.mjs"]
    environment:
      POSTGRES_URL: postgres://postgres:postgres@host.docker.internal:5432/postgres
      PHASE26_TICK_MS: "250"
      WORKER_OWNER: docker-wB
      PHASE32_CLAIM_ONE_SQL: sql/phase40_claim_one_tierA.sql
      PHASE32_MARK_SUCCESS_SQL: server/worker/phase32_mark_success.sql
      PHASE32_MARK_FAILURE_SQL: server/worker/phase32_mark_failure.sql
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

networks:
  mbhq_default:
    external: true
